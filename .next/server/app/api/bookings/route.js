(()=>{var e={};e.id=190,e.ids=[190],e.modules={6330:e=>{"use strict";e.exports=require("@prisma/client")},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},6358:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>f,routeModule:()=>k,serverHooks:()=>b,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{DELETE:()=>g,GET:()=>d,POST:()=>l});var n=t(2706),o=t(8203),a=t(5994),i=t(9187);function u(e){let r=new Date(Date.UTC(e,0,1));for(;1!==r.getUTCDay();)r.setUTCDate(r.getUTCDate()+1);return r}function c(e,r,t){let s=Math.floor(Math.floor((e.getTime()-t.getTime())/864e5)/7)+1;return e>=u(r+1)?{year:r+1,weekNumber:1}:{year:r,weekNumber:s}}let p=new(t(6330)).PrismaClient;async function d(e){try{let{searchParams:r}=new URL(e.url),t=e.headers.get("user-id"),s=r.get("weekNumber"),n=r.get("year"),o={};if(t){let e=parseInt(t,10);if(isNaN(e))return i.NextResponse.json({error:"Invalid user ID"},{status:400});o.userId=e}n&&s&&(o.year=Number(n),o.weekNumber=Number(s));let a=await p.booking.findMany({where:o,orderBy:{createdAt:"desc"}});return i.NextResponse.json(a,{status:200})}catch(e){return console.error("Error fetching bookings:",e),i.NextResponse.json({error:"Server error"},{status:500})}}async function l(e){try{let r=await e.json(),{year:t,weekNumber:s}=r;if(!t||!s){let{year:e,weekNumber:r}=function(e){let r=e.getUTCFullYear(),t=u(r);if(e>=u(r+1))return{year:r+1,weekNumber:1};if(e<t){let t=u(r-1);return c(e,r-1,t)}return c(e,r,t)}(new Date);t=e,s=r}let n=await p.booking.create({data:{...r,year:Number(t),weekNumber:Number(s),createdAt:r.createdAt||new Date}});return i.NextResponse.json(n,{status:201})}catch(e){return console.error("Error creating booking:",e),i.NextResponse.json({error:"Server error"},{status:500})}}async function g(e){try{let r=new URL(e.url).searchParams.get("id");if(!r)return i.NextResponse.json({error:"Missing ID"},{status:400});return await p.booking.delete({where:{id:Number(r)}}),i.NextResponse.json({message:"Booking deleted successfully"},{status:200})}catch(e){return console.error("Error deleting booking:",e),i.NextResponse.json({error:"Server error"},{status:500})}}let k=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/bookings/route",pathname:"/api/bookings",filename:"route",bundlePath:"app/api/bookings/route"},resolvedPagePath:"/Users/Fufu/booking/fish-booking-system/app/api/bookings/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:m,workUnitAsyncStorage:x,serverHooks:b}=k;function f(){return(0,a.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:x})}},6487:()=>{},8335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[994,452],()=>t(6358));module.exports=s})();