(()=>{var e={};e.id=407,e.ids=[407],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},9551:e=>{"use strict";e.exports=require("url")},3995:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(260),a=s(8203),l=s(5155),o=s.n(l),n=s(7292),i={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);s.d(t,i);let d=["",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1471)),"/Users/Fufu/booking/fish-booking-system/app/bookings/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,9611)),"/Users/Fufu/booking/fish-booking-system/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9937,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/Users/Fufu/booking/fish-booking-system/app/bookings/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/bookings/page",pathname:"/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3561:(e,t,s)=>{Promise.resolve().then(s.bind(s,1471))},9:(e,t,s)=>{Promise.resolve().then(s.bind(s,4243))},4243:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(5512),a=s(8009),l=s(6256);let o=s.n(l)()(async()=>{},{loadableGenerated:{modules:["app/components/BookingForm.tsx -> react-select"]},ssr:!1}),n=({setBookings:e,editingBooking:t,clearEditingBooking:s,firstInputRef:l})=>{let n=()=>{let e=new Date,t=[];for(let s=1;s<=6;s++){let r=new Date(e);r.setDate(e.getDate()+(s-e.getDay())),t.push(r.toISOString().split("T")[0])}return t},i=[{value:"3/4",label:"3/4"},{value:"4/5",label:"4/5"},{value:"5/6",label:"5/6"}],d=[{value:"Norway",label:"Norway"},{value:"Trout",label:"Trout"}],[c,u]=(0,a.useState)({code:"",team:"",customerGroup:"",customerName:"",fishSize:"",fishType:"",price:"",dailyQuantities:{}});(0,a.useEffect)(()=>{let e=n();t?u(t):u({code:"",team:"",customerGroup:"",customerName:"",fishSize:"",fishType:"",price:"",dailyQuantities:e.reduce((e,t)=>({...e,[t]:0}),{})}),l.current&&l.current.focus()},[t]);let m=e=>{let{name:t,value:s}=e.target;if(t.startsWith("day-")){let e=t.replace("day-","");u(t=>({...t,dailyQuantities:{...t.dailyQuantities,[e]:Number(s)}}))}else u(e=>({...e,[t]:s}))},x=(e,t)=>{u(s=>({...s,[e]:t.value}))},f=async r=>{if(r.preventDefault(),!c.code||!c.team||!c.customerGroup||!c.customerName||!c.price||0===Object.keys(c.dailyQuantities).length){alert("Please fill in all required fields.");return}try{let r=t?"PUT":"POST",a=t?`/api/bookings/${t.id}`:"/api/bookings",l=localStorage.getItem("userId");if(!l){alert("User is not logged in.");return}let o=await fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify({...c,userId:parseInt(l)})}),n=await o.json();if(!o.ok)throw Error(n.error||"Failed to save booking");t?(e(e=>e.map(e=>e.id===n.id?n:e)),alert("Booking updated!")):(e(e=>[...e,n]),alert("Booking saved!")),s?.()}catch(e){console.error("Error saving booking:",e),alert("Error saving booking.")}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 -z-10 overflow-hidden pointer-events-none opacity-20",children:(0,r.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 800 600",preserveAspectRatio:"xMidYMid slice",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"bgGradient",x1:"0",y1:"0",x2:"1",y2:"1",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#bae6fd"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#a7f3d0"})]})}),(0,r.jsx)("rect",{width:"800",height:"600",fill:"url(#bgGradient)"}),(0,r.jsx)("path",{fill:"#fff",d:"M0,300 C200,400 600,200 800,300 L800,600 L0,600 Z",opacity:"0.3"})]})}),(0,r.jsxs)("form",{onSubmit:f,className:"space-y-8 p-8 max-w-4xl mx-auto bg-white/80 backdrop-blur-md rounded-xl shadow-2xl relative z-10",children:[(0,r.jsx)("h1",{className:"text-3xl font-extrabold text-center text-blue-700 mb-6 drop-shadow-sm",children:t?"Edit Booking":"Add New Booking"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4 border-b border-gray-300 pb-2",children:"General Info"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Code ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("input",{ref:l,type:"text",name:"code",placeholder:"e.g., AB123",value:c.code,onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md focus:ring-2 focus:ring-blue-400 focus:outline-none transition duration-300 hover:shadow-md"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Team ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("input",{type:"text",name:"team",placeholder:"Team Name",value:c.team,onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md shadow-inner focus:ring-2 focus:ring-blue-400 focus:outline-none hover:shadow-lg"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Customer Group ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("input",{type:"text",name:"customerGroup",placeholder:"e.g., VIP Group",value:c.customerGroup,onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md shadow-inner focus:ring-2 focus:ring-blue-400 focus:outline-none hover:shadow-lg"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Customer Name ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("input",{type:"text",name:"customerName",placeholder:"e.g., John Doe",value:c.customerName,onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md shadow-inner focus:ring-2 focus:ring-blue-400 focus:outline-none hover:shadow-lg"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4 border-b border-gray-300 pb-2",children:"Fish Details"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Fish Size ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)(o,{options:i,placeholder:"Select size...",value:i.find(e=>e.value===c.fishSize),onChange:e=>x("fishSize",e),className:"rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:shadow-lg"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Fish Type ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)(o,{options:d,placeholder:"Select type...",value:d.find(e=>e.value===c.fishType),onChange:e=>x("fishType",e),className:"rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:shadow-lg"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:w-full md:w-1/4",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-800 mb-1",children:["Price (THB) ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("input",{type:"text",name:"price",placeholder:"e.g., 500",value:c.price,onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md shadow-inner focus:ring-2 focus:ring-blue-400 focus:outline-none hover:shadow-lg"}),(0,r.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:"Enter price in Thai Baht"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-800 mt-8 mb-4 border-b border-gray-300 pb-2",children:["Daily Quantities ",(0,r.jsx)("span",{className:"text-red-500"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Please fill in the quantity for each day."}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4 mt-4",children:Object.keys(c.dailyQuantities).map(e=>(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsx)("label",{className:"text-sm text-gray-700 font-medium mb-1",children:e}),(0,r.jsx)("input",{type:"number",name:`day-${e}`,placeholder:"0",value:c.dailyQuantities[e],onChange:m,className:"w-full p-2 bg-white/90 border-2 border-emerald-900 rounded-md shadow-inner focus:ring-2 focus:ring-blue-400 focus:outline-none transition duration-300 hover:shadow-lg"})]},e))})]}),(0,r.jsxs)("div",{className:"flex space-x-4 pt-6",children:[(0,r.jsx)("button",{type:"submit",className:"flex-1 py-3 bg-gradient-to-r from-blue-500 to-purple-900 text-white font-semibold rounded-lg hover:opacity-90 hover:scale-[1.02] focus:outline-none transition duration-300 shadow-lg",children:t?"Update Booking":"Save Booking"}),t&&(0,r.jsx)("button",{type:"button",onClick:s,className:"flex-1 py-3 bg-gray-300 text-gray-800 rounded-lg hover:bg-gray-400 focus:outline-none transition duration-300 shadow-lg",children:"Cancel"})]})]})]})},i=()=>{let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(null),o=(0,a.useRef)(null);(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("userId");if(!e){alert("User not logged in.");return}let s=await fetch("/api/bookings",{method:"GET",headers:{email:"",role:"user",userId:e}});if(!s.ok)throw Error(`Failed to fetch bookings: ${s.statusText}`);t(await s.json())})()},[]);let i=async s=>{try{(await fetch(`/api/bookings?id=${s}`,{method:"DELETE"})).ok?(t(e.filter(e=>e.id!==s)),alert("Booking deleted successfully!")):alert("Error deleting booking.")}catch(e){console.error("Error deleting booking:",e),alert("Error deleting booking.")}},d=e=>{l(e)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-teal-50 to-green-50 p-6 font-sans",children:[(0,r.jsx)("h1",{className:"text-4xl font-extrabold mb-6 text-center text-blue-700 drop-shadow-sm",children:"Fish Booking System"}),(0,r.jsx)("div",{className:"max-w-5xl mx-auto mb-10",children:(0,r.jsx)(n,{setBookings:t,editingBooking:s,clearEditingBooking:()=>{l(null)},firstInputRef:o})}),(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4 text-blue-600",children:"Your Bookings"}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsxs)("div",{className:"border border-white/30 p-4 rounded-xl shadow-md bg-white/70 backdrop-blur-sm flex flex-col space-y-4 transform hover:scale-[1.02] transition-transform duration-300",children:[(0,r.jsx)("div",{className:"font-bold text-lg text-blue-700",children:e.code}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Team:"})," ",e.team]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Customer Group:"})," ",e.customerGroup]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Customer:"})," ",e.customerName]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Fish Size:"})," ",e.fishSize]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Fish Type:"})," ",e.fishType]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Price:"})," ",e.price," THB"]}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Daily Quantities:"}),(0,r.jsx)("ul",{className:"ml-4 list-disc list-inside",children:Object.entries(e.dailyQuantities).map(([e,t])=>(0,r.jsxs)("li",{children:[(0,r.jsx)("span",{className:"text-gray-600",children:e}),": ",t," fish"]},e))})]}),(0,r.jsxs)("div",{className:"flex justify-between space-x-4 mt-4",children:[(0,r.jsx)("button",{onClick:()=>d(e),className:"bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition duration-300",children:"Edit"}),(0,r.jsx)("button",{onClick:()=>i(e.id),className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition duration-300",children:"Delete"})]})]},e.id))})]})}},6256:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let r=s(5488)._(s(568));function a(e,t){var s;let a={};"function"==typeof e&&(a.loader=e);let l={...a,...t};return(0,r.default)({...l,modules:null==(s=l.loadableGenerated)?void 0:s.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3400:(e,t)=>{"use strict";function s(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"encodeURIPath",{enumerable:!0,get:function(){return s}})},5771:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let r=s(4639);function a(e){let{reason:t,children:s}=e;throw new r.BailoutToCSRError(t)}},568:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let r=s(5512),a=s(8009),l=s(5771),o=s(6054);function n(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},d=function(e){let t={...i,...e},s=(0,a.lazy)(()=>t.loader().then(n)),d=t.loading;function c(e){let n=d?(0,r.jsx)(d,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,c=i?a.Suspense:a.Fragment,u=t.ssr?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.PreloadChunks,{moduleIds:t.modules}),(0,r.jsx)(s,{...e})]}):(0,r.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(c,{...i?{fallback:n}:{},children:u})}return c.displayName="LoadableComponent",c}},6054:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}});let r=s(5512),a=s(5740),l=s(9294),o=s(3400);function n(e){let{moduleIds:t}=e,s=l.workAsyncStorage.getStore();if(void 0===s)return null;let n=[];if(s.reactLoadableManifest&&t){let e=s.reactLoadableManifest;for(let s of t){if(!e[s])continue;let t=e[s].files;n.push(...t)}}return 0===n.length?null:(0,r.jsx)(r.Fragment,{children:n.map(e=>{let t=s.assetPrefix+"/_next/"+(0,o.encodeURIPath)(e);return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,a.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},1471:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/Fufu/booking/fish-booking-system/app/bookings/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/Fufu/booking/fish-booking-system/app/bookings/page.tsx","default")},6055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(8077);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[989,654,77,313],()=>s(3995));module.exports=r})();